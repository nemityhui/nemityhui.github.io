<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Быстрый Гонзалес - Полная история</title>
    <style>
        /* ... предыдущие стили ... */

        /* Новые анимации */
        @keyframes explosion {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(3); opacity: 0; }
        }

        @keyframes gonzalesRun {
            0% { left: 50%; transform: translateX(-50%); }
            100% { left: 100%; transform: translateX(100%) rotate(-15deg); }
        }

        .explosion {
            position: fixed;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, #ff4500 10%, #ff0000 70%);
            border-radius: 50%;
            animation: explosion 0.8s ease-out;
            pointer-events: none;
            display: none;
        }

        .gonzales {
            position: fixed;
            width: 120px;
            bottom: 20%;
            animation: gonzalesRun 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            display: none;
        }

        .dust {
            position: absolute;
            width: 50px;
            opacity: 0.7;
            animation: dustFade 1s ease-out;
        }

        @keyframes dustFade {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }
    </style>
</head>
<body>
    <!-- ... предыдущая разметка ... -->
    
    <div class="explosion"></div>
    <img src="https://static.wikia.nocookie.net/looneytunes/images/b/be/Speedy_Gonzales_2003.png" 
         class="gonzales" alt="Гонзалес">
    
    <script>
        // ... предыдущий код ...

        // Функция для кульминации
        function playClimax() {
            // Взрыв
            const explosion = document.querySelector('.explosion');
            explosion.style.display = 'block';
            explosion.style.left = `${Math.random() * 70 + 15}%`;
            explosion.style.top = `${Math.random() * 70 + 15}%`;
            
            // Звук взрыва
            const boomSound = new Audio('https://assets.mixkit.co/active_storage/sfx/2441/2441-preview.mp3');
            boomSound.volume = 0.5;
            boomSound.play();

            // Показ Гонзалеса
            const gonzales = document.querySelector('.gonzales');
            gonzales.style.display = 'block';
            
            // Запуск анимации через 200ms
            setTimeout(() => {
                gonzales.style.animation = 'gonzalesRun 1.5s forwards';
                
                // Эффект пыли
                const dust = document.createElement('img');
                dust.src = 'https://cdn-icons-png.flaticon.com/512/7403/7403785.png';
                dust.className = 'dust';
                dust.style.left = gonzales.offsetLeft + 'px';
                dust.style.bottom = '20%';
                document.body.appendChild(dust);
                
                setTimeout(() => dust.remove(), 1000);
            }, 200);

            // Сброс анимаций через 2 секунды
            setTimeout(() => {
                explosion.style.display = 'none';
                gonzales.style.display = 'none';
                gonzales.style.animation = '';
            }, 2000);
        }

        // Автоматический запуск при прокрутке к финалу
        const climaxTrigger = document.querySelector('.dialogue:last-child');
        const observer = new IntersectionObserver((entries) => {
            if(entries[0].isIntersecting) {
                playClimax();
            }
        }, { threshold: 0.5 });

        observer.observe(climaxTrigger);
    </script>
</body>
</html>
